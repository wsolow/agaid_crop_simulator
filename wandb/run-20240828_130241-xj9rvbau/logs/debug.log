2024-08-28 13:02:41,381 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Current SDK version is 0.17.7
2024-08-28 13:02:41,381 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Configure stats pid to 16399
2024-08-28 13:02:41,381 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Loading settings from /Users/wsolow/.config/wandb/settings
2024-08-28 13:02:41,381 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Loading settings from /Users/wsolow/Projects/agaid_crop_simulator/wandb/settings
2024-08-28 13:02:41,381 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train_agent.py', 'program_abspath': '/Users/wsolow/Projects/agaid_crop_simulator/train_agent.py', 'program': '/Users/wsolow/Projects/agaid_crop_simulator/train_agent.py'}
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_init.py:_log_setup():524] Logging user logs to /Users/wsolow/Projects/agaid_crop_simulator/wandb/run-20240828_130241-xj9rvbau/logs/debug.log
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_init.py:_log_setup():525] Logging internal logs to /Users/wsolow/Projects/agaid_crop_simulator/wandb/run-20240828_130241-xj9rvbau/logs/debug-internal.log
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_init.py:init():607] calling init triggers
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_init.py:init():614] wandb.init called with sweep_config: {}
config: {'npk': NPK_Args(seed=0, path=PosixPath('/Users/wsolow/Projects/agaid_crop_simulator'), output_vars=['DVS', 'LAI', 'RD', 'WSO', 'NuptakeTotal', 'PuptakeTotal', 'KuptakeTotal', 'NAVAIL', 'PAVAIL', 'KAVAIL', 'WC'], weather_vars=['IRRAD', 'TMIN', 'TMAX', 'TEMP', 'VAP', 'RAIN', 'WIND'], intvn_interval=1, num_fert=2, num_irrig=2, n_recovery=0.7, p_recovery=0.7, k_recovery=0.7, fert_amount=2, irrig_amount=0.5, beta=10.0, agro_fpath='env_config/agro_config/test_agro_npk.yaml', crop_fpath='env_config/crop_config/', site_fpath='env_config/site_config/', random_reset=False), 'exp_name': 'dqn', 'seed': 1, 'torch_deterministic': True, 'cuda': True, 'track': True, 'wandb_project_name': 'dqn_npk', 'wandb_entity': 'test', 'capture_video': False, 'save_model': False, 'upload_model': False, 'hf_entity': '', 'env_id': 'npk-v0', 'total_timesteps': 500000, 'learning_rate': 0.00025, 'num_envs': 1, 'buffer_size': 10000, 'gamma': 0.99, 'tau': 1.0, 'target_network_frequency': 500, 'batch_size': 128, 'start_e': 1, 'end_e': 0.05, 'exploration_fraction': 0.5, 'learning_starts': 10000, 'train_frequency': 10}
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_init.py:init():657] starting backend
2024-08-28 13:02:41,382 INFO    MainThread:16399 [wandb_init.py:init():661] setting up manager
2024-08-28 13:02:41,386 INFO    MainThread:16399 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2024-08-28 13:02:41,388 INFO    MainThread:16399 [wandb_init.py:init():669] backend started and connected
2024-08-28 13:02:41,397 INFO    MainThread:16399 [wandb_init.py:init():764] updated telemetry
2024-08-28 13:02:41,417 INFO    MainThread:16399 [wandb_init.py:init():797] communicating run to backend with 90.0 second timeout
2024-08-28 13:02:41,417 ERROR   MainThread:16399 [wandb_init.py:init():1235] error in wandb.init()
Traceback (most recent call last):
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1225, in init
    return wi.init()
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 799, in init
    run_init_handle = backend.interface.deliver_run(run)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 840, in deliver_run
    run_record = self._make_run(run)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 157, in _make_run
    self._make_config(data=config_dict, obj=proto_run.config)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 139, in _make_config
    update.value_json = json_dumps_safer(json_friendly(v)[0])
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/util.py", line 831, in json_dumps_safer
    return dumps(obj, cls=WandBJSONEncoder, **kwargs)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/site-packages/wandb/util.py", line 782, in default
    return json.JSONEncoder.default(self, obj)
  File "/opt/miniconda3/envs/cropsim/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type PosixPath is not JSON serializable
2024-08-28 13:02:42,538 WARNING MsgRouterThr:16399 [router.py:message_loop():77] message_loop has been closed
